package com.redhat.unit.entitiesTests;

import com.redhat.tasksyncer.dao.entities.AbstractIssue;
import com.redhat.tasksyncer.dao.entities.GithubIssue;
import com.redhat.tasksyncer.dao.enumerations.IssueType;
import org.junit.Before;
import org.junit.Test;
import org.kohsuke.github.GHEventPayload;
import org.kohsuke.github.GHIssue;
import org.kohsuke.github.GHUser;
import org.kohsuke.github.GitHub;
import org.springframework.mock.web.MockHttpServletRequest;

import java.io.IOException;
import java.util.Date;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import static org.assertj.core.api.AssertionsForClassTypes.assertThat;

// TODO: Try to initialize the ghissue via webhook callback, as the jira from webhook convertor testing
public class GithubIssueTests {

    GHIssue ghIssue;
    List<String> labels;

    String label_name = "label";
    String assigneeName = "assignee";
    String titleOne = "Title_one";
    String description = "description";
    Date dueDate = new Date();
    Date createdAt = new Date();
    Date closedAt = new Date();

    String ghIssueCallback = "{\"action\":\"labeled\",\"issue\":{\"url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/16\",\"repository_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo\",\"labels_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/16/labels{/name}\",\"comments_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/16/comments\",\"events_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/16/events\",\"html_url\":\"https://github.com/DavidRajnoha/TestingRepo/issues/16\",\"id\":503351245,\"node_id\":\"MDU6SXNzdWU1MDMzNTEyNDU=\",\"number\":16,\"title\":\"Issue\",\"user\":{\"login\":\"DavidRajnoha\",\"id\":40993541,\"node_id\":\"MDQ6VXNlcjQwOTkzNTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/40993541?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/DavidRajnoha\",\"html_url\":\"https://github.com/DavidRajnoha\",\"followers_url\":\"https://api.github.com/users/DavidRajnoha/followers\",\"following_url\":\"https://api.github.com/users/DavidRajnoha/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/DavidRajnoha/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/DavidRajnoha/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/DavidRajnoha/subscriptions\",\"organizations_url\":\"https://api.github.com/users/DavidRajnoha/orgs\",\"repos_url\":\"https://api.github.com/users/DavidRajnoha/repos\",\"events_url\":\"https://api.github.com/users/DavidRajnoha/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/DavidRajnoha/received_events\",\"type\":\"User\",\"site_admin\":false},\"labels\":[{\"id\":1513694603,\"node_id\":\"MDU6TGFiZWwxNTEzNjk0NjAz\",\"url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/labels/bug\",\"name\":\"bug\",\"color\":\"d73a4a\",\"default\":true}],\"state\":\"open\",\"locked\":false,\"assignee\":{\"login\":\"DavidRajnoha\",\"id\":40993541,\"node_id\":\"MDQ6VXNlcjQwOTkzNTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/40993541?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/DavidRajnoha\",\"html_url\":\"https://github.com/DavidRajnoha\",\"followers_url\":\"https://api.github.com/users/DavidRajnoha/followers\",\"following_url\":\"https://api.github.com/users/DavidRajnoha/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/DavidRajnoha/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/DavidRajnoha/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/DavidRajnoha/subscriptions\",\"organizations_url\":\"https://api.github.com/users/DavidRajnoha/orgs\",\"repos_url\":\"https://api.github.com/users/DavidRajnoha/repos\",\"events_url\":\"https://api.github.com/users/DavidRajnoha/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/DavidRajnoha/received_events\",\"type\":\"User\",\"site_admin\":false},\"assignees\":[{\"login\":\"DavidRajnoha\",\"id\":40993541,\"node_id\":\"MDQ6VXNlcjQwOTkzNTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/40993541?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/DavidRajnoha\",\"html_url\":\"https://github.com/DavidRajnoha\",\"followers_url\":\"https://api.github.com/users/DavidRajnoha/followers\",\"following_url\":\"https://api.github.com/users/DavidRajnoha/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/DavidRajnoha/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/DavidRajnoha/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/DavidRajnoha/subscriptions\",\"organizations_url\":\"https://api.github.com/users/DavidRajnoha/orgs\",\"repos_url\":\"https://api.github.com/users/DavidRajnoha/repos\",\"events_url\":\"https://api.github.com/users/DavidRajnoha/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/DavidRajnoha/received_events\",\"type\":\"User\",\"site_admin\":false}],\"milestone\":null,\"comments\":0,\"created_at\":\"2019-10-07T10:03:04Z\",\"updated_at\":\"2019-10-07T10:03:04Z\",\"closed_at\":null,\"author_association\":\"OWNER\",\"body\":\"Example+Issue+Webhook+Callback+for+Testing\"},\"label\":{\"id\":1513694603,\"node_id\":\"MDU6TGFiZWwxNTEzNjk0NjAz\",\"url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/labels/bug\",\"name\":\"bug\",\"color\":\"d73a4a\",\"default\":true},\"repository\":{\"id\":203802518,\"node_id\":\"MDEwOlJlcG9zaXRvcnkyMDM4MDI1MTg=\",\"name\":\"TestingRepo\",\"full_name\":\"DavidRajnoha/TestingRepo\",\"private\":false,\"owner\":{\"login\":\"DavidRajnoha\",\"id\":40993541,\"node_id\":\"MDQ6VXNlcjQwOTkzNTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/40993541?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/DavidRajnoha\",\"html_url\":\"https://github.com/DavidRajnoha\",\"followers_url\":\"https://api.github.com/users/DavidRajnoha/followers\",\"following_url\":\"https://api.github.com/users/DavidRajnoha/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/DavidRajnoha/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/DavidRajnoha/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/DavidRajnoha/subscriptions\",\"organizations_url\":\"https://api.github.com/users/DavidRajnoha/orgs\",\"repos_url\":\"https://api.github.com/users/DavidRajnoha/repos\",\"events_url\":\"https://api.github.com/users/DavidRajnoha/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/DavidRajnoha/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/DavidRajnoha/TestingRepo\",\"description\":null,\"fork\":false,\"url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo\",\"forks_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/forks\",\"keys_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/teams\",\"hooks_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/hooks\",\"issue_events_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/events\",\"assignees_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/tags\",\"blobs_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/languages\",\"stargazers_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/stargazers\",\"contributors_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/contributors\",\"subscribers_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/subscribers\",\"subscription_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/subscription\",\"commits_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/merges\",\"archive_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/downloads\",\"issues_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/deployments\",\"created_at\":\"2019-08-22T13:36:54Z\",\"updated_at\":\"2019-08-22T13:36:58Z\",\"pushed_at\":\"2019-08-22T13:36:56Z\",\"git_url\":\"git://github.com/DavidRajnoha/TestingRepo.git\",\"ssh_url\":\"git@github.com:DavidRajnoha/TestingRepo.git\",\"clone_url\":\"https://github.com/DavidRajnoha/TestingRepo.git\",\"svn_url\":\"https://github.com/DavidRajnoha/TestingRepo\",\"homepage\":null,\"size\":0,\"stargazers_count\":0,\"watchers_count\":0,\"language\":null,\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":15,\"license\":null,\"forks\":0,\"open_issues\":15,\"watchers\":0,\"default_branch\":\"master\"},\"sender\":{\"login\":\"DavidRajnoha\",\"id\":40993541,\"node_id\":\"MDQ6VXNlcjQwOTkzNTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/40993541?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/DavidRajnoha\",\"html_url\":\"https://github.com/DavidRajnoha\",\"followers_url\":\"https://api.github.com/users/DavidRajnoha/followers\",\"following_url\":\"https://api.github.com/users/DavidRajnoha/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/DavidRajnoha/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/DavidRajnoha/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/DavidRajnoha/subscriptions\",\"organizations_url\":\"https://api.github.com/users/DavidRajnoha/orgs\",\"repos_url\":\"https://api.github.com/users/DavidRajnoha/repos\",\"events_url\":\"https://api.github.com/users/DavidRajnoha/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/DavidRajnoha/received_events\",\"type\":\"User\",\"site_admin\":false}}";
    String ghEmptyIssueCallback = "{\"action\":\"opened\",\"issue\":{\"url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/17\",\"repository_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo\",\"labels_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/17/labels{/name}\",\"comments_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/17/comments\",\"events_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/17/events\",\"html_url\":\"https://github.com/DavidRajnoha/TestingRepo/issues/17\",\"id\":503359965,\"node_id\":\"MDU6SXNzdWU1MDMzNTk5NjU=\",\"number\":17,\"title\":\"EmptyIssue\",\"user\":{\"login\":\"DavidRajnoha\",\"id\":40993541,\"node_id\":\"MDQ6VXNlcjQwOTkzNTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/40993541?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/DavidRajnoha\",\"html_url\":\"https://github.com/DavidRajnoha\",\"followers_url\":\"https://api.github.com/users/DavidRajnoha/followers\",\"following_url\":\"https://api.github.com/users/DavidRajnoha/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/DavidRajnoha/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/DavidRajnoha/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/DavidRajnoha/subscriptions\",\"organizations_url\":\"https://api.github.com/users/DavidRajnoha/orgs\",\"repos_url\":\"https://api.github.com/users/DavidRajnoha/repos\",\"events_url\":\"https://api.github.com/users/DavidRajnoha/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/DavidRajnoha/received_events\",\"type\":\"User\",\"site_admin\":false},\"labels\":[],\"state\":\"open\",\"locked\":false,\"assignee\":null,\"assignees\":[],\"milestone\":null,\"comments\":0,\"created_at\":\"2019-10-07T10:20:48Z\",\"updated_at\":\"2019-10-07T10:20:48Z\",\"closed_at\":null,\"author_association\":\"OWNER\",\"body\":\"\"},\"repository\":{\"id\":203802518,\"node_id\":\"MDEwOlJlcG9zaXRvcnkyMDM4MDI1MTg=\",\"name\":\"TestingRepo\",\"full_name\":\"DavidRajnoha/TestingRepo\",\"private\":false,\"owner\":{\"login\":\"DavidRajnoha\",\"id\":40993541,\"node_id\":\"MDQ6VXNlcjQwOTkzNTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/40993541?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/DavidRajnoha\",\"html_url\":\"https://github.com/DavidRajnoha\",\"followers_url\":\"https://api.github.com/users/DavidRajnoha/followers\",\"following_url\":\"https://api.github.com/users/DavidRajnoha/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/DavidRajnoha/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/DavidRajnoha/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/DavidRajnoha/subscriptions\",\"organizations_url\":\"https://api.github.com/users/DavidRajnoha/orgs\",\"repos_url\":\"https://api.github.com/users/DavidRajnoha/repos\",\"events_url\":\"https://api.github.com/users/DavidRajnoha/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/DavidRajnoha/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/DavidRajnoha/TestingRepo\",\"description\":null,\"fork\":false,\"url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo\",\"forks_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/forks\",\"keys_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/teams\",\"hooks_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/hooks\",\"issue_events_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/events\",\"assignees_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/tags\",\"blobs_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/languages\",\"stargazers_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/stargazers\",\"contributors_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/contributors\",\"subscribers_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/subscribers\",\"subscription_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/subscription\",\"commits_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/merges\",\"archive_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/downloads\",\"issues_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/DavidRajnoha/TestingRepo/deployments\",\"created_at\":\"2019-08-22T13:36:54Z\",\"updated_at\":\"2019-08-22T13:36:58Z\",\"pushed_at\":\"2019-08-22T13:36:56Z\",\"git_url\":\"git://github.com/DavidRajnoha/TestingRepo.git\",\"ssh_url\":\"git@github.com:DavidRajnoha/TestingRepo.git\",\"clone_url\":\"https://github.com/DavidRajnoha/TestingRepo.git\",\"svn_url\":\"https://github.com/DavidRajnoha/TestingRepo\",\"homepage\":null,\"size\":0,\"stargazers_count\":0,\"watchers_count\":0,\"language\":null,\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":16,\"license\":null,\"forks\":0,\"open_issues\":16,\"watchers\":0,\"default_branch\":\"master\"},\"sender\":{\"login\":\"DavidRajnoha\",\"id\":40993541,\"node_id\":\"MDQ6VXNlcjQwOTkzNTQx\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/40993541?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/DavidRajnoha\",\"html_url\":\"https://github.com/DavidRajnoha\",\"followers_url\":\"https://api.github.com/users/DavidRajnoha/followers\",\"following_url\":\"https://api.github.com/users/DavidRajnoha/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/DavidRajnoha/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/DavidRajnoha/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/DavidRajnoha/subscriptions\",\"organizations_url\":\"https://api.github.com/users/DavidRajnoha/orgs\",\"repos_url\":\"https://api.github.com/users/DavidRajnoha/repos\",\"events_url\":\"https://api.github.com/users/DavidRajnoha/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/DavidRajnoha/received_events\",\"type\":\"User\",\"site_admin\":false}}";

    MockHttpServletRequest servletRequest;

    Map<String, String> columnMapping = new LinkedHashMap<>();


    @Before
    public void setup() throws IOException {
        GHUser assignee = new GHUser();

        ghIssue = new GHIssue();

        servletRequest = new MockHttpServletRequest();
        servletRequest.addHeader("key", "value");
        servletRequest.setContent(ghIssueCallback.getBytes());


        columnMapping.put("OPEN", AbstractIssue.STATE_OPENED);
        columnMapping.put("CLOSED", AbstractIssue.STATE_CLOSED);
  /*    Throws NullPointerException, because some field that can not be set here is empty...

        ghIssue.setTitle(titleOne);
        ghIssue.setBody(description);
        ghIssue.setLabels(label_name);
        ghIssue.setAssignees(assignee);*/
    }

    @Test
    public void whenConvertingIEPayload_thenAllFieldsShouldBeTransmitted() throws IOException {

        GHEventPayload.Issue issueEventPayload = GitHub.connectAnonymously().parseEventPayload(servletRequest.getReader(), GHEventPayload.Issue.class);


        AbstractIssue convertedIssue = GithubIssue.ObjectToGithubIssueConverter.convert(issueEventPayload.getIssue()
                , columnMapping);
        assertThat(convertedIssue.getIssueType()).isEqualTo(IssueType.GITHUB);
        assertThat(convertedIssue.getTitle()).isEqualTo("Issue");
        //TODO: Check why are the plus signs there
        assertThat(convertedIssue.getDescription()).isEqualTo("Example+Issue+Webhook+Callback+for+Testing");
        assertThat(convertedIssue.getAssignee()).isEqualTo("DavidRajnoha");
        assertThat(convertedIssue.getState()).isEqualTo(AbstractIssue.STATE_OPENED);
        assert(convertedIssue.getLabels().contains("bug"));
    }

    @Test public void whenConvertingInputWithNullFields_thenNoUncheckedExceptionIsThrown() throws IOException {

        servletRequest.setContent(ghEmptyIssueCallback.getBytes());

        GHEventPayload.Issue emptyIssueEventPayload = GitHub.connectAnonymously().parseEventPayload(servletRequest.getReader(), GHEventPayload.Issue.class);

        GithubIssue.ObjectToGithubIssueConverter.convert(emptyIssueEventPayload.getIssue(), columnMapping);
    }
}
